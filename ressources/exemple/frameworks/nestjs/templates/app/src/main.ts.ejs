import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';
import { DocumentBuilder, SwaggerModule } from '@nestjs/swagger';
import { ConfigService } from '@nestjs/config';

async function bootstrap() {
const app = await NestFactory.create(AppModule);
const configService = app.get(ConfigService);
const port = configService.get
<number>('APP_PORT') || 3000;

    // Activation de CORS (si besoin pour un frontend Angular)
    app.enableCors({
    origin: configService.get
    <string>('CORS_ORIGIN') || '*',
        methods: 'GET,HEAD,PUT,PATCH,POST,DELETE',
        allowedHeaders: 'Content-Type, Authorization',
        });

        // Configuration de Swagger
        const swaggerConfig = new DocumentBuilder()
        .setTitle('API Documentation')
        .setDescription('Documentation de l\'API NestJS')
        .setVersion('1.0')
        .addBearerAuth() // Ajoute l'authentification JWT
        .build();

        const document = SwaggerModule.createDocument(app, swaggerConfig);
        SwaggerModule.setup('api', app, document);

        // DÃ©marrage du serveur
        await app.listen(port);
        console.log(`ðŸš€ Application is running on: http://localhost:${port}`);
        console.log(`ðŸ“œ Swagger is available at: http://localhost:${port}/api`);
        }
        bootstrap();
