import { Injectable } from '@nestjs/common';
import { InjectRepository } from '@nestjs/typeorm';
import { Repository } from 'typeorm';
<% let entities = new Set(); %>
<% let typeEntity = entity.typeEntity %>
<% imports.forEach(module => { 
  let moduleName = module.replace(/,\n?/g, '').trim().replace('Module', '');
  entities.add(moduleName);  
  let folder = ejsHelpers.pascalToKebab(moduleName);
_%>
<%  if (typeEntity !== 'pivot') { _%>
//<%= typeEntity %>
import { <%= moduleName %> } from '../modules/<%= folder %>/entities/<%= folder %>.entity';
import { <%= moduleName %>Mock } from '../modules/<%= folder %>/<%= folder %>.mock';
<%  } _%>
<% }); %>

@Injectable()
export class FixturesService {
  constructor(
    <% entities.forEach(entity => { _%>      
    <%  if (typeEntity != 'pivot') { _%>
    @InjectRepository(<%= entity %>) private readonly <%= ejsHelpers.pascalToCamel(entity) %>Repository: Repository<<%= entity %>>,
    <%  }; _%>
    <% }); %>     
  ) {}
  <% entities.forEach(entity => { _%>
  <%  if (typeEntity != 'pivot') { _%>
    async load<%= entity %>() {
      const <%= ejsHelpers.pascalToCamel(entity) %> = <%= entity %>Mock;     
      await this.<%= ejsHelpers.pascalToCamel(entity) %>Repository.save( <%= ejsHelpers.pascalToCamel(entity) %>);
      console.log('<%= entity %> loaded');
    }
    <%  }; _%>
    <% }); %> 


  async loadAllFixtures() {
    <% entities.forEach(entity => { _%>
      <% if(typeEntity != 'pivot') { _%>
        await this.load<%= entity %>();
      <%  }; _%>
    <% }); %>     
    console.log('All fixtures loaded successfully.');
  }
}